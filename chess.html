<head>
  <title>Chess</title>
</head>

<body>
  <!--  A container is recommended for Meteor -->
  <div class="container">
    {{>main}} <!-- everything starts with a root Meteor template -->
  </div>
</body>

<!-- this is the root Meteor template for everything -->
<template name="main">
  {{! calls the login package control for creating account or logging in, and displays user name}}
  <h2>Welcome to Meteor Chess by Steven J. Halasz, {{>loginButtons}}!</h2> 
  {{#if currentUser}} 
    {{#if inGame}} {{! if in a game, use inGame template}}
      {{>inGameTemplate}}
    {{else}} {{! if not in a game, use getGame template}}
      {{>getGameTemplate}}
    {{/if}} {{! end of #if inGame}}
  {{else }} {{! if not logged in}}
    {{>notLoggedInTemplate}}
  {{/if}} {{! end of #if currentUser}}
</template>

<template name="inGameTemplate">
      {{#each games}}
        {{> gameTemplate}}
      {{/each}}
</template>

<template name="gameTemplate">
  <div style="font-size:24px;color:red">
    {{#if alert}}
      {{alert}}
      <button class="continue">Continue</button>
    {{/if}}
  </div>
  {{bname}} 
  {{#if equals black turn}}
    {{{countdown btime ctime}}}
  {{else}}
    {{roundSeconds btime}}
  {{/if}}
  {{#if equals3 black myid turn}}
    {{#if notOver}}
      {{> promptForMove}}
    {{/if}}
  {{/if}}
  <br />
  <code style="font-size:24px">
    {{{nl2brnbsp ascii}}}
  </code>
  <br />
  {{wname}} 
  {{#if equals white turn}}
    {{{countdown wtime ctime}}}
  {{else}}
    {{roundSeconds wtime}}
  {{/if}}
  {{#if equals3 white myid turn}}
    {{#if notOver}}
      {{> promptForMove}}
    {{/if}}
  {{/if}}
  <br />
  {{#if notOver}} 
   <button class="resign">Resign</button>
  {{/if}}
</template>

<template name="promptForMove">
    <br />
    Type a move in algebraic notation and press enter.
    <br />
    <input> {{message}}
</template>

<template name="getGameTemplate">
  Click on a user name to offer or accept a game. When you offer, the name turns green. When someone offers to you, the name turns red.
  <br />
  <br />
  {{#each users}}
    {{>userTemplate}}
  {{/each}}
</template>

<template name="userTemplate">
  <li style="color:{{#if equals myid offerTo}} red {{else}} {{#if equals myid offerFrom}} green {{else}} black {{/if}}{{/if}}">{{user}}</li>
</template>

<template name="notLoggedInTemplate">
  Click "Sign In" above to log in or create a new user account.
</template>

